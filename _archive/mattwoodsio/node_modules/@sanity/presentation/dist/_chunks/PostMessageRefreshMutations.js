import{jsx as e}from"react/jsx-runtime";import{memo as n,useMemo as r,useState as l,useEffect as t,startTransition as i}from"react";import{getPublishedId as o,useEditState as d}from"sanity";function u(e){const{channel:n,draft:r,published:o,livePreviewEnabled:d}=e,[u,a]=l(r),[s,c]=l(o);return t((()=>{(null==u?void 0:u._rev)!==(null==r?void 0:r._rev)&&(i((()=>a(r))),r&&(null==n||n.send("overlays","presentation/refresh",{source:"mutation",livePreviewEnabled:d,document:v(r)}))),(null==s?void 0:s._rev)!==(null==o?void 0:o._rev)&&(i((()=>c(o))),o&&(null==n||n.send("overlays","presentation/refresh",{source:"mutation",livePreviewEnabled:d,document:v(o)})))}),[n,r,d,null==u?void 0:u._rev,null==s?void 0:s._rev,o]),null}function v(e){const{_id:n,_type:r,_rev:l,slug:t}=e;return{_id:n,_type:r,_rev:l,slug:t}}var a=n((function(n){const{channel:l,type:t,previewKitConnection:i,loadersConnection:v}=n,a=r((()=>o(n.id)),[n.id]),{draft:s,published:c,ready:p}=d(a,t,"low");return p&&s||c?e(u,{channel:l,draft:s,livePreviewEnabled:"connected"===i||"connected"===v,published:c},a):null}));export{a as default};//# sourceMappingURL=PostMessageRefreshMutations.js.map
