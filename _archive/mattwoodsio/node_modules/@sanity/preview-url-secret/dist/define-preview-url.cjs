"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=require("./_chunks/constants.cjs");exports.definePreviewUrl=function(r){const{draftMode:t,previewMode:n,origin:i=(typeof location>"u"?"https://localhost":location.origin)}=r,a=(null==n?void 0:n.enable)||(null==t?void 0:t.enable);let{preview:o="/"}=r;const s=new URL(o,i),c=a?new URL(a,i):void 0;return async t=>{try{if(t.previewSearchParam){const e=new URL(t.previewSearchParam,s);e.origin===s.origin&&(o=`${e.pathname}${e.search}`)}else if(t.referrer){const e=new URL(t.referrer);e.origin===s.origin&&(o=`${e.pathname}${e.search}`)}}catch{}typeof location<"u"&&location.origin===s.origin&&t.studioBasePath&&(o.startsWith(`${t.studioBasePath}/`)||o===t.studioBasePath)&&(o=r.preview||"/");const n=new URL(o,s);if(c){const r=new URL(c),{searchParams:i}=r;return i.set(e.u,t.previewUrlSecret),n.pathname!==r.pathname&&i.set(e.b,`${n.pathname}${n.search}`),r.toString()}return n.toString()}};//# sourceMappingURL=define-preview-url.cjs.map
