{"version":3,"file":"index.umd.js","sources":["../index.ts"],"sourcesContent":["import {useState, useEffect} from 'react'\n\nexport interface DevicePixelRatioOptions {\n  /**\n   * Default DPR to use if browser does not support the `devicePixelRatio`\n   * property, or when rendering on server\n   *\n   * @defaultValue `1`\n   */\n  defaultDpr?: number\n\n  /**\n   * Whether or not to round the number down to the closest integer\n   *\n   * @defaultValue `true`\n   */\n  round?: boolean\n\n  /**\n   * Maximum DPR to return (set to `2` to only generate 1 and 2)\n   *\n   * @defaultValue `3`\n   */\n  maxDpr?: number\n}\n\n/**\n * Get the device pixel ratio, potentially rounded and capped.\n * Will emit new values if it changes.\n *\n * @param options\n * @returns The current device pixel ratio, or the default if none can be resolved\n */\nexport function useDevicePixelRatio(options?: DevicePixelRatioOptions) {\n  const dpr = getDevicePixelRatio(options)\n  const [currentDpr, setCurrentDpr] = useState(dpr)\n  const {defaultDpr, maxDpr, round} = options || {}\n\n  useEffect(() => {\n    const canListen = typeof window !== 'undefined' && 'matchMedia' in window\n    if (!canListen) {\n      return\n    }\n\n    const updateDpr = () => setCurrentDpr(getDevicePixelRatio({defaultDpr, maxDpr, round}))\n    const mediaMatcher = window.matchMedia(`screen and (resolution: ${currentDpr}dppx)`)\n\n    // Safari 13.1 does not have `addEventListener`, but does have `addListener`\n    if (mediaMatcher.addEventListener) {\n      mediaMatcher.addEventListener('change', updateDpr)\n    } else {\n      mediaMatcher.addListener(updateDpr)\n    }\n\n    return () => {\n      if (mediaMatcher.removeEventListener) {\n        mediaMatcher.removeEventListener('change', updateDpr)\n      } else {\n        mediaMatcher.removeListener(updateDpr)\n      }\n    }\n  }, [currentDpr, defaultDpr, maxDpr, round])\n\n  return currentDpr\n}\n\n/**\n * Returns the current device pixel ratio (DPR) given the passed options\n *\n * @param options\n * @returns current device pixel ratio\n */\nexport function getDevicePixelRatio(options?: DevicePixelRatioOptions): number {\n  const {defaultDpr = 1, maxDpr = 3, round = true} = options || {}\n  const hasDprProp = typeof window !== 'undefined' && typeof window.devicePixelRatio === 'number'\n  const dpr = hasDprProp ? window.devicePixelRatio : defaultDpr\n  const rounded = Math.min(Math.max(1, round ? Math.floor(dpr) : dpr), maxDpr)\n  return rounded\n}\n"],"names":["useDevicePixelRatio","options","dpr","getDevicePixelRatio","currentDpr","setCurrentDpr","useState","defaultDpr","maxDpr","round","useEffect","canListen","window","updateDpr","mediaMatcher","matchMedia","addEventListener","addListener","removeEventListener","removeListener","hasDprProp","devicePixelRatio","rounded","Math","min","max","floor"],"mappings":";;;;;EA0BA;;;;;;EAMG;;EACG,SAAUA,mBAAV,CAA8BC,OAA9B,EAA+D;EACnE,EAAA,MAAMC,GAAG,GAAGC,mBAAmB,CAACF,OAAD,CAA/B,CAAA;EACA,EAAM,MAAA,CAACG,UAAD,EAAaC,aAAb,IAA8BC,cAAQ,CAACJ,GAAD,CAA5C,CAAA;EACA,EAAM,MAAA;EAACK,IAAAA,UAAD;EAAaC,IAAAA,MAAb;EAAqBC,IAAAA,KAAAA;EAArB,GAA8BR,GAAAA,OAAO,IAAI,EAA/C,CAAA;EAEAS,EAAAA,eAAS,CAAC,MAAK;EACb,IAAMC,MAAAA,SAAS,GAAG,OAAOC,MAAP,KAAkB,WAAlB,IAAiC,gBAAgBA,MAAnE,CAAA;;EACA,IAAI,IAAA,CAACD,SAAL,EAAgB;EACd,MAAA,OAAA;EACD,KAAA;;EAED,IAAA,MAAME,SAAS,GAAG,MAAMR,aAAa,CAACF,mBAAmB,CAAC;EAACI,MAAAA,UAAD;EAAaC,MAAAA,MAAb;EAAqBC,MAAAA,KAAAA;EAArB,KAAD,CAApB,CAArC,CAAA;;EACA,IAAMK,MAAAA,YAAY,GAAGF,MAAM,CAACG,UAAP,CAA6C,CAAA,wBAAA,EAAAX,UAAiB,CAAA,KAAA,CAA9D,CAArB,CAPa;;EAUb,IAAIU,IAAAA,YAAY,CAACE,gBAAjB,EAAmC;EACjCF,MAAAA,YAAY,CAACE,gBAAb,CAA8B,QAA9B,EAAwCH,SAAxC,CAAA,CAAA;EACD,KAFD,MAEO;EACLC,MAAAA,YAAY,CAACG,WAAb,CAAyBJ,SAAzB,CAAA,CAAA;EACD,KAAA;;EAED,IAAA,OAAO,MAAK;EACV,MAAIC,IAAAA,YAAY,CAACI,mBAAjB,EAAsC;EACpCJ,QAAAA,YAAY,CAACI,mBAAb,CAAiC,QAAjC,EAA2CL,SAA3C,CAAA,CAAA;EACD,OAFD,MAEO;EACLC,QAAAA,YAAY,CAACK,cAAb,CAA4BN,SAA5B,CAAA,CAAA;EACD,OAAA;EACF,KAND,CAAA;EAOD,GAvBQ,EAuBN,CAACT,UAAD,EAAaG,UAAb,EAAyBC,MAAzB,EAAiCC,KAAjC,CAvBM,CAAT,CAAA;EAyBA,EAAA,OAAOL,UAAP,CAAA;EACD,CAAA;EAED;;;;;EAKG;;EACG,SAAUD,mBAAV,CAA8BF,OAA9B,EAA+D;EACnE,EAAM,MAAA;EAACM,IAAAA,UAAU,GAAG,CAAd;EAAiBC,IAAAA,MAAM,GAAG,CAA1B;EAA6BC,IAAAA,KAAK,GAAG,IAAA;EAArC,GAA6CR,GAAAA,OAAO,IAAI,EAA9D,CAAA;EACA,EAAA,MAAMmB,UAAU,GAAG,OAAOR,MAAP,KAAkB,WAAlB,IAAiC,OAAOA,MAAM,CAACS,gBAAd,KAAmC,QAAvF,CAAA;EACA,EAAMnB,MAAAA,GAAG,GAAGkB,UAAU,GAAGR,MAAM,CAACS,gBAAV,GAA6Bd,UAAnD,CAAA;EACA,EAAMe,MAAAA,OAAO,GAAGC,IAAI,CAACC,GAAL,CAASD,IAAI,CAACE,GAAL,CAAS,CAAT,EAAYhB,KAAK,GAAGc,IAAI,CAACG,KAAL,CAAWxB,GAAX,CAAH,GAAqBA,GAAtC,CAAT,EAAqDM,MAArD,CAAhB,CAAA;EACA,EAAA,OAAOc,OAAP,CAAA;EACD;;;;;;;;;"}